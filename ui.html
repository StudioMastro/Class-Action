<link rel="stylesheet" href="../../node_modules/figma-plugin-ds/dist/figma-plugin-ds.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&display=swap"
  rel="stylesheet">


<style>
  body {
    font-family: 'DM Sans', sans-serif;
    padding: 2rem;
  }

  div {
    margin: 1rem;
  }

  input {
    display: block;
    margin-bottom: 1rem;
  }

  .class-actions {
    display: flex;
    justify-content: space-between;
  }
</style>

<h1>Class Action</h1>

<div class="switch">
  <input class="switch__toggle" type="checkbox" id="dark-mode-on">
  <label class="switch__label" for="dark-mode-on">Dark Mode</label>
</div>

<div>
  <label for="classNameInput">Class name</label>
  <input class="input__field" type="text" id="classNameInput" placeholder="Choose Class name" />
  <button onclick="saveClass()">Save class</button>
</div>
<div id="classList"></div>
<script>
  function saveClass() {
    const className = document.getElementById('classNameInput').value;
    window.parent.postMessage({ pluginMessage: { type: 'save-class', className } }, '*');
  }

  function deleteClass(className) {
    window.parent.postMessage({ pluginMessage: { type: 'delete-class', className } }, '*');
  }

  function renameClass(oldName) {
    const newName = prompt('Enter new class name:', oldName);
    if (newName && newName !== oldName) {
      window.parent.postMessage({ pluginMessage: { type: 'rename-class', oldName, newName } }, '*');
    }
  }

  function applyClass(className) {
    window.parent.postMessage({ pluginMessage: { type: 'apply-class', className } }, '*');
  }

  onmessage = (event) => {
    if (event.data.pluginMessage.type === 'display-saved-classes') {
      const savedClasses = event.data.pluginMessage.savedClasses;
      const classList = document.getElementById('classList');
      classList.innerHTML = '';

      for (const className in savedClasses) {
        const classDiv = document.createElement('div');
        classDiv.innerHTML = `
              <div class="class-actions">
                <span>${className}</span>
                <div>
                  <button class="button button--primary" onclick="applyClass('${className}')">Apply</button>
                  <button class="button button--secondary" onclick="renameClass('${className}')">Rename</button>
                  <button class="button button--secondary" onclick="deleteClass('${className}')">Delete</button>
                </div>
              </div>
            `;
        classList.appendChild(classDiv);
      }
    }
  };
</script>